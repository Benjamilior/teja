#"Cookie": "VtexRCMacIdv7=52b0def1-c28b-4fa8-a5f6-d0013f1d113c; checkout.vtex.com=__ofid=babf99464ed64d6cad9028e1cd72a5a1; CheckoutOrderFormOwnership=; _gcl_au=1.1.1592692913.1711125031; _clck=8jiea8%7C2%7Cfkm%7C0%7C1542; _tt_enable_cookie=1; _ttp=22QBg6fGZXo8znsQlZfontlFqLd; _ga_N1YLB7KMPJ=GS1.1.1712176826.15.0.1712176826.0.0.0; _ga=GA1.1.1979233254.1711125037; urlLastSearch=http://unimarc.vtexcommercestable.com.br/busca/?ft=azucar%20blanca%20iansa%20750%20g; _ga_NFQV9S3REJ=GS1.3.1711125931.1.0.1711125931.60.0.0; IPI=UrlReferrer=https%3a%2f%2fwww.google.com%2f; janus_sid=a953a138-edaa-4bcd-b683-895d88e4ce1c; vtex_session=eyJhbGciOiJFUzI1NiIsImtpZCI6Ijc4MjJFQUNERTc1RjYxNkEwRjU4OUREQ0JBQ0NCOUY1NjkxREUwQTgiLCJ0eXAiOiJqd3QifQ.eyJhY2NvdW50LmlkIjoiZTUxM2NmODktN2E5MC00NmI1LTg3MTYtOGYwMjVjZjBiOGM2IiwiaWQiOiI5ZDRiMDNkMy04MmQwLTRmMmQtYjg3Ni02OTM3ZjA2ZjcyN2YiLCJ2ZXJzaW9uIjoyLCJzdWIiOiJzZXNzaW9uIiwiYWNjb3VudCI6InNlc3Npb24iLCJleHAiOjE3MTI3NTg1NzcsImlhdCI6MTcxMjA2NzM3NywiaXNzIjoidG9rZW4tZW1pdHRlciIsImp0aSI6ImI5ZTVlNzkwLTgwYjItNDhmZi1hNTVhLTNhMGJmOGNhMDJjOCJ9.iMdZAKcQvP5rBYsgYc43jJ5XtCCiHowvqiLXd-68N2Rv_kt-Qxi-V_cSz8ldiFukhtr1-H_w1Onm3XczgPf9qA; vtex_segment=eyJjYW1wYWlnbnMiOm51bGwsImNoYW5uZWwiOiIxIiwicHJpY2VUYWJsZXMiOm51bGwsInJlZ2lvbklkIjpudWxsLCJ1dG1fY2FtcGFpZ24iOm51bGwsInV0bV9zb3VyY2UiOm51bGwsInV0bWlfY2FtcGFpZ24iOiJub3QtZm91bmQtYWNlaXRlIG9saXZhLWV4LXZpcmdlbi1uYXR1cmEtMS1sdCIsImN1cnJlbmN5Q29kZSI6IkNMUCIsImN1cnJlbmN5U3ltYm9sIjoiJCIsImNvdW50cnlDb2RlIjoiQ0hMIiwiY3VsdHVyZUluZm8iOiJlcy1DTCIsImNoYW5uZWxQcml2YWN5IjoicHVibGljIn0; VTEXSC=sc=1; ISSMB=ScreenMedia=0&UserAcceptMobile=False; ISICI=InternalCampaign=not-found-aceite+oliva-ex-virgen-natura-1-lt; ISS=InternalCampaign=not-found-aceite%2boliva-ex-virgen-natura-1-lt; _clsk=1vl79j2%7C1712176817371%7C1%7C1%7Ca.clarity.ms%2Fcollect; VtexRCSessionIdv7=f36a4631-cb3b-42b3-aa80-469acb94f3ce; SGTS=EF4D8204957EDBCCE377CB3FA297EBF0; _clsk=1vl79j2%7C1712176817371%7C1%7C1%7Ca.clarity.ms%2Fcollect; _clsk=1vl79j2%7C1712176817371%7C1%7C1%7Ca.clarity.ms%2Fcollect",
import requests
import time
import json
import datetime
import pandas as pd
from googleapiclient.discovery import build
from google.oauth2 import service_account

start_time = time.time() 
# Google Sheets
SCOPES = ['https://www.googleapis.com/auth/spreadsheets']
KEY = 'key.json'  # Cambiar check
SPREADSHEET_ID = '1LnQY2tABOaIN86_q80p24RNGFR3h_eTI9JVOF6HfeB4'  # Cambiar check

# Cargar las credenciales de servicio de Google Sheets
creds = service_account.Credentials.from_service_account_file(KEY, scopes=SCOPES)
service = build('sheets', 'v4', credentials=creds)
sheet = service.spreadsheets()

# Definir la URL base
base_url = "https://unimarc.vtexcommercestable.com.br/api/catalog_system/pub/products/variations/"

# Definir el diccionario de sku
sku = {
    "7613037071399": "67289",
    "7802000014925": "85294",
    "7802215508530": "1029",
    "7802215508523": "1028",
    "220": "9998",
    "768": "194",
    "628": "376",
    "12255": "279",
    "7802800533589": "1691",
    "7802000014703": "84616",
    "7802420151477": "83304",
    "7802420151057": "83303",
    "7802420001840": "12815",
    "7793100111891": "8913",
    "7802100505354": "7905",
    "7622201693091": "1412",
    "7797453001533": "11404",
    "7801620005160": "4440",
    "7802920007410": "4148",
    "7802118000018": "13637",
    "7802575533586": "57153",
    "7801300000447": "971",
    "8006550340230": "51351",
    "7802420002182": "1318",
    "41333000985": "4618",
    "23025": "9720",
    "7802215108174": "76040",
    "7702367463421": "78124",
    "7802410001621": "7032",
    "7801505001713": "1388",
    "4000417018007": "12976",
    "4000417700001": "53188",
    "7802215501838": "4976",
    "7790119010894": "80550",
    "7803111001705": "11505",
    "7896019208468": "1066",
    "8801055709212": "67298",
    "8801055709274": "61700",
    "7613031891344": "85034",
    "7802410003182": "8386",
    "7802710835155": "7641",
    "7802710835216": "7642",
    "7802710832116": "1742",
    "7802950002133": "89",
    "7702010130243": "3766",
    "7702010130250": "3304",
    "7802420007934": "83692",
    "7802420007927": "83691",
    "7613287103529": "73420",
    "7802900130114": "402",
    "7802900001414": "50432",
    "7613287593283": "76301",
    "7790290001193": "13795",
    "7802107000869": "5536",
    "7801365000284": "510",
    "7802575034014": "48",
    "7613032596668": "9969",
    "7891000248768": "57685",
    "7805000141271": "141",
    "7804615340109": "14551",
    "7802230076298": "4707",
    "7802230070012": "2220",
    "7802900002855": "82959",
    "23049": "4998",
    "7804300143657": "54313",
    "7804945002197": "4552",
    "7802920777283": "7840",
    "7804300143671": "40639",
    "4005900376459": "3682",
    "7802710350504": "1741",
    "7500435160544": "83795",
    "7802000015632": "77942",
    "7802000015649": "77943",
    "7896004004549": "85927",
    "7613035652101": "1320",
    "7808704700850": "12107",
    "7808704700966": "62989",
    "7802420007958": "83667",
    "70847009511": "1474",
    "7802215511011": "181",
    "7801620370107": "4688",
    "8410376017113": "11942",
    "7802230086952": "1734",
    "7613034891730": "7339",
    "7804522005535": "59430",
    "7802225682121": "3715",
    "7802940001795": "9934",
    "8001665700047": "9908",
    "7802940730701": "3478",
    "7809611708410": "1403",
    "7809611700513": "556",
    "7802626161010": "59454",
    "7802626100057": "36948",
    "7790272001005": "1415",
    "7802626001477": "80381",
    "7802820441802": "35704",
    "7797453001519": "11406",
    "7802615006551": "31",
    "7804920007605": "85002",
    "7702367003900": "76142",
    "7899916911967": "61072",
    "7702367003917": "76143",
    "22085": "84557",
    "7805000322014": "82895",
    "7802000013621": "65158",
    "7802000013607": "65157",
    "7801230004409": "77057",
    "7801230004416": "77058",
    "7802920777542": "2897",
    "7801610001622": "4675",
    "7802920007403": "4146",
    "7803111001682": "7024",
    "7801315000326": "10676",
    "7802950002126": "90",
    "7802920202105": "411",
    "7802920203300": "410",
    "7802920203409": "413",
    "7802420124525": "5208",
    "21000026326": "1052",
    "7803908006197": "71838",
    "7613287593481": "81024",
    "7809611700667": "5707",
    "80177173": "560",
    "7802100000330": "7901",
    "7802100001788": "1324",
    "7802130003042": "82577",
    "7801300301049": "689",
    "7809611701268": "699",
    "7803403003271": "84872",
    "7803480001313": "75042",
    "7613034721051": "948",
    "7803480001269": "71356",
    "7802230070227": "167",
    "7803473212238": "4745",
    "7803480000309": "11065",
    "7806500174202": "4789",
    "7801300000096": "960",
    "7801300000072": "713",
    "23028": "76683",
    "7802920000435": "600",
    "7806500509820": "14535",
    "99176480310": "3543",
    "7891024005064": "8002",
    "7801300000065": "714",
    "7801970026433": "11486",
    "7808704700843": "1372",
    "7808704700973": "56603",
    "7809611707468": "1197",
    "7806300010021": "4596",
    "7802175455493": "6970",
    "7802175455912": "1537",
    "7802225640770": "1475",
    "7802215502262": "4715",
    "7802926001580": "32287",
    "7802926000033": "11632",
    "7802926000071": "11626",
    "7802926000132": "11628",
    "7802926000101": "11627",
    "7802926000149": "1775",
    "7802926000750": "1776",
    "7802926000170": "11630",
    "7802926001849": "83630",
    "79344007273": "5295",
    "79344007204": "5296",
    "79344007235": "13848",
    "451": "259",
    "7802215508547": "1030",
    "7802215505027": "5185",
    "7802225682107": "5597",
    "1361": "1288",
    "825": "73510",
    "7801970004783": "526",
    "7801930019055": "68397",
    "7809611719171": "76792",
    "54": "9853",
    "7797453000796": "41356",
    "7797453000802": "11108",
    "7797453000475": "6548",
    "7802615005615": "29",
    "70177078966": "11392",
    "7806500406747": "79285",
    "7802615005103": "25",
    "7806500406709": "73675",
    "7806500406839": "83254",
    "7802615005202": "24",
    "7802095180123": "12281",
    "7802615005400": "27",
    "7730219021390": "76406",
    "7804300121396": "5724",
    "7804320750552": "71748",
    "7801235131117": "35",
    "7804320758626": "85244",
    "8410113002150": "11018",
    "7804626930054": "74790",
    "7797453972345": "5837",
    "7797453972260": "776",
    "7797453972291": "5841",
    "7802920007120": "4867",
    "80432400432": "8923",
    "5000267014005": "68",
    "7790272007366": "82712",
    "8715200813061": "4560",
    "7802920000084": "2898",
    "7802920000091": "2899",
    "7802410001379": "7860",
    "7802337910945": "68992",
    "7802351001803": "74074",
    "7802575533616": "57156",
    "4067700018243": "878",
    "7800120162922": "71431",
    "23042": "1122",
    "7802420127113": "662",
    "7802920001326": "752",
    "21000026968": "1055",
    "7801620853396": "1764",
    "7801875069368": "550",
    "7802130002274": "3597",
    "4009900412087": "55915",
    "7896019208451": "6720",
    "7801806000026": "10970",
    "7802420510151": "888",
    "7802420510113": "873",
    "7803403003257": "84808",
    "7802200230293": "83839",
    "7802420002359": "4040",
    "8410036009090": "34574",
    "7790520992963": "77095",
    "7804000001455": "11144",
    "7802100003218": "65657",
    "7804615340000": "6032",
    "4053400279398": "85239",
    "7613033725333": "4196",
    "7801315151516": "10791",
    "7802110002973": "73785",
    "7801305004099": "4369",
    "7802225582476": "85014",
    "7801235000284": "15611",
    "7622201797560": "76627",
    "99": "1488",
    "7802900001339": "1488",
    "7809611700261": "5172",
    "7500435128612": "54018",
    "7801300000157": "700",
    "7804320449098": "1266",
    "7802500008042": "7782",
    "7804300010614": "79",
    "7804300122959": "727",
    "7622201693138": "6804",
    "7804320746104": "52632",
    "5000299628034": "78800",
    "7801300002328": "54620",
    "7803960100307": "36326",
    "7804673610121": "83417",
    "70177197360": "74328",
    "7802800579587": "7272",
    "7802800579518": "7264",
    "7794000744257": "8805",
    "7802337910907": "68936",
    "7804619570038": "940",
    "8006550342067": "84040",
    "7801610002650": "5065",
    "7802900001421": "54363",
    "7801620001223": "5182",
    "7804086000311": "65349",
    "7801960000290": "53807",
    "7805040001832": "3614",
    "7801970001034": "6794",
    "7801620001643": "5217",
    "7861002900117": "35041",
    "7613287581099": "78247",
    "7802410305033": "2920",
    "7802920221328": "482",
    "7802225280655": "5590",
    "8445290091833": "82344",
    "7802130002373": "75949",
    "7802100003768": "73564",
    "7802100004758": "82948",
    "7803468001427": "44681",
    "7803468002257": "4741",
    "7802930003679": "1462",
    "7806500512318": "84800",
    "7801970000143": "10879",
    "7802410112136": "4954",
    "7791290792487": "1556",
    "76150601244": "6314",
    "7802410101376": "5321",
    "7802930002504": "852",
    "7802920000749": "753",
    "7802920006529": "48856",
    "4008455458618": "66686",
    "7802225427586": "12921",
    "7613036566377": "56056",
    "7802180068169": "14",
    "78895126396": "25579",
    "7804658470085": "14502",
    "650240011832": "63944",
    "7802575004437": "46",
    "22000018489": "430",
    "7613030518426": "10878",
    "7896029046296": "6544",
    "7802410137108": "3588",
    "4792055026642": "85458",
    "70177177430": "74492",
    "7804630010582": "8781",
    "7898591453274": "85510",
    "7803960100109": "4480",
    "7803960100208": "36296",
    "7805025692079": "5761",
    "7804330141111": "5676",
    "7806810000574": "124",
    "7804454001537": "12731",
    "7808729601200": "12086",
    "7808729601736": "14014",
    "7804320256900": "73",
    "7802410400356": "6190",
    "7804454000882": "13855",
    "7804335004589": "65628",
    "7804300143688": "54315",
    "7804330006946": "13875",
    "7808704701031": "67154",
    "7802900028473": "3374",
    "7802920007137": "4064",
    "7802910083509": "5573",
    "7804600778924": "5718",
    "7804600770171": "5719",
    "7804320365848": "10952",
    "7801620011628": "1760",
    "7801930000602": "256",
    "7792410010009": "57216",
    "7802175453222": "5517",
    "7802900002107": "61860",
    "7801300000034": "715",
    "7802900002138": "61859",
    "7802920003429": "85134",
    "7802095000209": "35057",
    "7802920801681": "1791",
    "7802900001360": "86",
    "7808760900478": "1069",
    "7802500037059": "495",
    "7802950006612": "425",
    "7702027042010": "32787",
    "7804335171113": "5697",
    "8711000509388": "73861",
    "7804320272252": "720",
    "7613037071368": "61704",
    "7707211631469": "6228",
    "7808704700164": "5367",
    "7808704700003": "5246",
    "715126000116": "437",
    "7804315001065": "5375",
    "7803110102212": "32",
    "7804300123925": "5148",
    "7804320389318": "37524",
    "7804340909053": "7960",
    "82184000335": "6945",
    "7790272007885": "82713",
    "7802930004843": "74724",
    "7805000321581": "78826",
    "7613030049883": "7816",
    "7805000321567": "78659",
    "7804918401651": "1229",
    "7802575353047": "246",
    "7802351451400": "4738",
    "7802810002099": "3",
    "7802640720538": "10838",
    "7802575341143": "5532",
    "7613032203795": "1033",
    "7802575341136": "649",
    "7802950012316": "1731",
    "7806500225812": "19803",
    "7801970026082": "520",
    "7801875047137": "5102",
    "7801505231950": "7844",
    "7802575004635": "7762",
    "7801610000571": "3964",
    "8445290118288": "82334",
    "8445290841575": "85211",
    "7896005806760": "71999",
    "7802820650013": "1172",
    "7801875047113": "5103",
    "7801610000601": "3968",
    "7801875052056": "558",
    "7806500225522": "120",
    "7801610001295": "471",
    "7801875069177": "226",
    "7801620852955": "152",
    "7801620017552": "5202",
    "9002490214852": "6651",
    "7802107000074": "5536",
    "7792798012947": "54965",
    "7801620011604": "3169",
    "7802100004024": "75996",
    "7613039352151": "11983",
    "9002490221010": "1549",
    "7802200848375": "5265",
    "9002490100070": "5333",
    "7801620006341": "14827",
    "7613036188302": "14908",
    "40000514251": "12539",
    "7801620000738": "1763",
    "7801610002261": "451",
    "7801620011611": "1759",
    "7501003698742": "82372",
    "7802215121319": "1429",
    "7802100003249": "61424",
    "7802200134010": "84667",
    "7801300001024": "11513",
    "7801300000218": "5664",
    "7802100004000": "76013",
    "7802215121258": "1134",
    "7613034439277": "1561",
    "7802900105013": "7842",
    "7898024396994": "54539",
    "7898024395072": "8163",
    "7802215104855": "7132",
    "7614500010013": "175",
    "7802215101625": "11187",
    "7802215505058": "7478",
    "7801300305047": "5662",
    "7802920776163": "459",
    "7802900401016": "3150",
    "7802920221458": "4897",
    "7802920007397": "11300",
    "7802920007182": "3409",
    "5000267116419": "1573",
    "7802920005928": "11519",
    "7802900001209": "1339",
    "7802920006352": "11112",
    "7802900001926": "50431",
    "7802920006741": "1288",
    "7802920004112": "50449",
    "7802000015182": "74804",
    "7802000017629": "84616",
    "8410113005298": "7966",
    "7804330006922": "705",
    "7802940002006": "9917",
    "7802920242514": "3232",
    "7312040017010": "4915",
    "7804300000363": "53956",
    "7891136057029": "52858",
    "5000329002254": "18",
    "7802110001952": "1398",
    "7802110001402": "1010",
    "7804300129491": "78",
    "7802080000146": "841",
    "7804454005764": "12827",
    "7804300121440": "4765",
    "7804454001384": "10399",
    "7804309000449": "40068",
    "8000368244605": "44555",
    "7802950006766": "4930",
    "7804330121113": "5669",
    "7804300131715": "35948",
    "8000368219801": "1453",
    "5014271360423": "32530",
    "5014271794181": "32530",
    "7804300010508": "7947",
    "7801960000320": "53809",
    "7802940002013": "9934",
    "41390001017": "74665",
    "7804300121457": "229",
    "7802351001810": "74075",
    "70177197230": "74492",
    "7790520001009": "3591",
    "7790520012524": "6761",
    "7803300300640": "4776",
    "7801930009308": "16004",
    "7801930001586": "85492",
    "7801610591888": "1722",
    "7802410350651": "6187",
    "7798140253808": "81239",
    "7791293046242": "49085",
    "7802100003270": "50528",
    "7801930008219": "13353",
    "34000174140": "4335",
    "7809611718723": "76743",
    "7804000002575": "80905",
    "7804627650227": "11012",
    "7804627650258": "11054",
    "7803520002355": "83969",
    "7804677280061": "84306",
    "8445290587947": "83627",
    "7802920003313": "11773",
    "7802920010632": "85259",
    "7804632980142": "12748",
    "79400301161": "7070",
    "7802955010850": "55715",
    "7802920002293": "754",
    "7802960808121": "1460",
    "7804320753607": "13807",
    "7804300157647": "85110"
}

sku2 = {
    "7613037071399": "67289",
    "7802000014925": "85294"}


payload = ""

# Definir los headers
headers = {
    "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/124.0",
    "Accept": "*/*",
    "Accept-Language": "en-US,es-CL;q=0.7,en;q=0.3",
    "Accept-Encoding": "gzip, deflate, br",
    "X-Requested-With": "XMLHttpRequest",
    "Connection": "keep-alive",
    "Referer": "https://unimarc.vtexcommercestable.com.br/nescafe-fina-seleccion-espresso-100-gr/p",
    "Sec-Fetch-Dest": "empty",
    "Sec-Fetch-Mode": "cors",
    "Sec-Fetch-Site": "same-origin"
}

price_data = []

# Iterar sobre cada sku en el diccionario
for producto, nombre_producto in sku.items():
    # Construir la URL para la solicitud GET
    url_sku = base_url + nombre_producto
    
    # Realizar la solicitud GET
    response = requests.request("GET", url_sku, data=payload, headers=headers)
    data = response.json()
    
    # Agregar los datos al price_data
    price_data.append((producto, data))


# Lista para almacenar la información de cada producto
product_info_list = []

# Iterar sobre cada elemento en price_data
for sku, product_data in price_data:
    # Verificar si el elemento es un diccionario de producto
    if isinstance(product_data, dict) and 'name' in product_data:
        # Obtener el nombre del producto
        product_name = product_data.get('name', 'Nombre no encontrado')
        
        # Obtener el precio mejor formateado
        best_price_formated = product_data.get('skus', [{}])[0].get('bestPriceFormated', 'Precio no encontrado')
        
        # Obtener el precio de lista formateado
        list_price_formated = product_data.get('skus', [{}])[0].get('listPriceFormated', 'Precio no encontrado')
        
        # Agregar la información del producto a la lista
        product_info_list.append({
            'SKU': sku,
            'Nombre': product_name,
            'Precio mejor formateado': best_price_formated,
            'Precio de lista formateado': list_price_formated
        })

# Imprimir la información de cada producto
for product_info in product_info_list:
    print("SKU:", product_info['SKU'])
    print("Nombre:", product_info['Nombre'])
    print("Precio mejor formateado:", product_info['Precio mejor formateado'])
    print("Precio de lista formateado:", product_info['Precio de lista formateado'])
    print("-----------------------------")  # Agregar una línea en blanco entre productos

values = [[product['SKU'], product['Nombre'], product['Precio mejor formateado'], product['Precio de lista formateado']] for product in product_info_list]

# Enviar los datos a Google Sheets
result = sheet.values().update(
    spreadsheetId=SPREADSHEET_ID,
    range='Unimarc!A2',  # Comenzar desde la celda A2
    valueInputOption='USER_ENTERED',
    body={'values': values}
).execute()

print("Datos insertados correctamente en Google Sheets")

df = pd.DataFrame(price_data)

end_time = time.time()  # Tiempo de finalización de la ejecución
execution_time = end_time - start_time
print("Tiempo de ejecución: %.2f segundos" % execution_time) 

now = datetime.datetime.now()
now_str = now.strftime('%Y-%m-%d %H:%M:%S')
data = {"": now_str}
json_data = json.dumps(data)
values = [[json_data]]
result = sheet.values().update(spreadsheetId=SPREADSHEET_ID,
                                range='Unimarc!J2',  # CAMBIAR
                                valueInputOption='USER_ENTERED',
                                body={'values': values}).execute()
  

competitor = "Unimarc"  # Cambiar 

df = pd.DataFrame(product_info_list )

# Enviar datos a otro Google Sheets
SCOPES = ['https://www.googleapis.com/auth/spreadsheets']
KEY = 'key.json'
NEW_SPREADSHEET_ID = '1y-NLrx7pewwMP1OGzLTZcpolTBkhiz5yZAhTohBGFKE'  # ID de la nueva hoja de cálculo

creds = service_account.Credentials.from_service_account_file(KEY, scopes=SCOPES)
service = build('sheets', 'v4', credentials=creds)
sheet = service.spreadsheets()

# Obtener la última fila con datos en la nueva hoja
result = sheet.values().get(spreadsheetId=NEW_SPREADSHEET_ID, range='tejamarket!A:A').execute() #Cambiar donde llega la info
values = result.get('values', [])
last_row = len(values) + 1  # Obtener el índice de la última fila vacía

# Convertir resultados a la lista de valores
values = [[row['SKU'], competitor, row['Precio mejor formateado'],row['Precio de lista formateado'], now_str] for _, row in df.iterrows()]
# values = [[row['SKU'], competitor, product['Nombre'], product['Precio mejor formateado'], product['Precio de lista formateado']] for product in product_info_list]

# Insertar los resultados en la nueva hoja después de la última fila
    
update_range = f'tejamarket!A{last_row}:F{last_row + len(values) - 1}' #Cambiar
result = sheet.values().update(
    spreadsheetId=NEW_SPREADSHEET_ID,
    range=update_range,
    valueInputOption='USER_ENTERED',
    body={'values': values}
).execute()

print(f"Datos insertados correctamente en la nueva hoja de Google Sheets en el rango {update_range}")
    